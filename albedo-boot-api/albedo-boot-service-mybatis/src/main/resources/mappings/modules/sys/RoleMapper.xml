<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.albedo.java.modules.sys.domain.Role">


    <resultMap id="RoleResultMap" type="com.albedo.java.modules.sys.domain.Role">
        <id property="id" column="id" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="createdBy" column="createdBy" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="createdDate" column="createdDate" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="dataScope" column="dataScope" javaType="java.lang.Integer" jdbcType="INTEGER"/>
        <result property="description" column="description" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="en" column="en" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="lastModifiedBy" column="lastModifiedBy" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="lastModifiedDate" column="lastModifiedDate" javaType="java.util.Date" jdbcType="TIMESTAMP"/>
        <result property="name" column="name" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="orgId" column="orgId" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="sysData" column="sysData" javaType="java.lang.Integer" jdbcType="INTEGER"/>
        <result property="sort" column="sort" javaType="java.lang.Integer" jdbcType="INTEGER"/>
        <result property="status" column="status" javaType="java.lang.Integer" jdbcType="INTEGER"/>
        <result property="type" column="type" javaType="java.lang.String" jdbcType="VARCHAR"/>
        <result property="version" column="version" javaType="java.lang.Integer" jdbcType="INTEGER"/>
        <association column="org" property="org" select="com.albedo.java.modules.sys.repository.OrgRepository.selectById"/>
    </resultMap>

    <sql id="pageRoleColumn">
        `role`.id_ AS `id`,
        `role`.created_by AS `createdBy`,
        `role`.created_date AS `createdDate`,
        `role`.data_scope AS `dataScope`,
        `role`.description_ AS `description`,
        `role`.en_ AS `en`,
        `role`.last_modified_by AS `lastModifiedBy`,
        `role`.last_modified_date AS `lastModifiedDate`,
        `role`.name_ AS `name`,
        `role`.org_id AS `orgId`,
        `role`.sys_data AS `sysData`,
        `role`.sort_ AS `sort`,
        `role`.status_ AS `status`,
        `role`.type_ AS `type`,
        `role`.version_ AS `version`,
    </sql>

    <select id="addRoleOrgs" parameterType="com.albedo.java.modules.sys.domain.Role">
        insert into sys_role_org_t (role_id, org_id)
        values
        <foreach collection="role.orgIdList" item="item" separator=",">
            (#{role.id},#{item})
        </foreach>
    </select>

    <select id="deleteRoleOrgs" parameterType="com.albedo.java.modules.sys.domain.Role">
        DELETE FROM sys_role_org_t where role_id=#{role.id}
    </select>

    <select id="addRoleModules" parameterType="com.albedo.java.modules.sys.domain.Role">
        insert into sys_role_module_t (role_id, module_id)
        values
        <foreach collection="role.moduleIdList" item="item" separator=",">
            (#{role.id},#{item})
        </foreach>
    </select>
    <select id="deleteRoleModules" parameterType="com.albedo.java.modules.sys.domain.Role">
        DELETE FROM sys_role_module_t where role_id=#{role.id}
    </select>
</mapper>
